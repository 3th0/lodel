<?php
$current = "database";
include("tpl/install-openhtml.html");
?>
<!--[

  LODEL - Logiciel d'Edition ELectronique.

  Copyright (c) 2001-2002, Ghislain Picard, Marin Dacos
  Copyright (c) 2003, Ghislain Picard, Marin Dacos, Luc Santeramo, Nicolas Nutten, Anne Gentil-Beccot
 *  Copyright (c) 2004, Ghislain Picard, Marin Dacos, Luc Santeramo, Anne Gentil-Beccot, Bruno Cénou

  Home page: http://www.lodel.org

  E-Mail: lodel@lodel.org

                            All Rights Reserved

     This program is free software; you can redistribute it and/or modify
     it under the terms of the GNU General Public License as published by
     the Free Software Foundation; either version 2 of the License, or
     (at your option) any later version.

     This program is distributed in the hope that it will be useful,
     but WITHOUT ANY WARRANTY; without even the implied warranty of
     MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
     GNU General Public License for more details.

     You should have received a copy of the GNU General Public License
     along with this program; if not, write to the Free Software
     Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.
]-->

<!--[ ce fichier n'est pas un template ]-->

<h2>Choix de la base de données.</h2>


<?php if ($installoption==1) { // OPTION 1 ?>
<p align="justify">
[@INSTALL.CHOOSE_PREEXISTING_DATABASE_OR_CREATE_NEW].<br/>[@INSTALL.USUALLY_PROVIDER_CREATE_DATABASE_SEE_TECHNICAL_SUPPORT].</p>
<?php } else { // OPTION 2 ?>
<p align="justify">
[@INSTALL.CAN_USE_PREEXISTING_DATABASE_BUT_BETTER_CREATE_NEW_DEDICATED_LODEL] <?php if (!$createdatabase) { ?> [@INSTALL.EXAMPLE_LODELDB] <?php } ?> :
</p>
<p>
<code>
CREATE database <?php if ($createdatabase) { echo "$createdatabase"; } else { echo "lodeldb";} ?>;
</code>
</p>
<p>
[@INSTALL.ANYWAY_GIVE_RIGHTS_"ALL"_TO_DATABASE_USER] "<?php echo $dbusername; ?>":
<p>
<p>
<code>
GRANT ALL ON <?php if ($createdatabase) { echo "$createdatabase"; } else { echo "lodeldb";} ?>.* TO <?php echo "$dbusername@$dbhost";?>;
</code>
</p>
<p align="justify">
[@INSTALL.WHY_PREFIX_TABLE].
</p>
<p align="justify">
[@INSTALL.ONE_LODEL_INSTALLATION_CAN_ADMINISTRATE_SEVERAL_WEBSITES_SO_CHOOSE] : 
<ul>
<li>[@INSTALL.ONE_DATABASE_FOR_ALL_WEBSITES_ADVANTAGES_INCONVENIENCES].
<li>[@INSTALL.ONE_DATABASE_FOR_ONE_WEBSITE_PLUS_MAIN_DATABASE_RECOMMENDED_SOLUTION] !
</ul>
</p>
<?php } // fin OPTION 2 ?>


<?php  if ($erreur_createdatabase) { ?> <b>[@INSTALL.ERROR]</b>: [@INSTALL.UNABLE_TO_CREATE_OR_ACCESS_DATABASE_ERROR_IS|sprintf([#DATABASE])] : <?php  echo mysql_error(); ?> <?php } ?>

<?php  if ($erreur_usedatabase) { ?> <b>[@INSTALL.ERROR]</b>: [@INSTALL.DATABASE_USE_IMPOSSIBLE_CHECK_DATABASEUSER_RIGHTS_ERROR_IS] : <?php  echo mysql_error(); ?> <?php } ?>

<?php  if ($erreur_createtables) { ?> <b>[@INSTALL.ERROR]</b>: [@INSTALL.TABLE_CREATION_FAILED_SQL_INSTRUCTION_AND_ERROR_ARE] : <?php echo $erreur_createtables; ?> <?php } ?>

<?php  if ($erreur_tablesexist) { ?> <b>[@INSTALL.WARNING]</b>: [@INSTALL.SELECTED_DATABASE_CONTENT_DATAS_FOR_LODEL_YOU_CAN_SAVE_DATAS_OR_ERASE_OR_SELECT_OTHER_DATABASES].
<form method="post" action="install.php">
<input type="hidden" name="tache" value="database">
<input type="submit" name="continue" value="[@INSTALL.CONTINUE]">
<input type="submit" name="erasetables" value="[@INSTALL.ERASE_DATAS]">
</form>
<br/>
<?php } ?>

<hr style="width: 100%; height: 2px;">

<form method="post" action="install.php">
<input type="hidden" name="tache" value="database">
<table cellspacing="0" cellpadding="0">
<tr>
<th>&nbsp;

</th>
<th>
[@INSTALL.DATABASE] :
</th>
			  <?php  if (!$resultshowdatabases) $resultshowdatabases=@mysql_query("SHOW DATABASES");
	                     if (!$resultshowdatabases && mysql_error()) { // can't do show databases
			  ?>
<tr>
<td>
<input type="radio" name="newdatabase" value="-1" <?php  if ($existingdatabase) echo "checked"; ?> ></td>
<td>[@INSTALL.USE_PREEXISTING_EMPTY_DATABASE] : <input type="text" size="20" name="existingdatabase" value="<?php echo $existingdatabase; ?>"></td>
</tr>
	                  <?php
	                     } else {
	                     while ($row=mysql_fetch_array($resultshowdatabases)) {
			     			$dbname=$row[0];
			     			if ($database==$dbname) {
			         			$checked="checked"; $oneischecked=1;
			     			} else {
			         			$checked="";
			     			}
                          
			  			?>
			  				<tr><td><input type="radio" name="newdatabase" value="<?php echo $dbname; ?>" <?php echo $checked; ?>></td><td><?php echo $dbname; ?></td></tr>
		          <?php  
							}
						}
			 ?>
			  <tr><td><input type="radio" name="newdatabase" value="-2" <?php  if (!$oneischecked) echo "checked"; ?> ></td><td>[@INSTALL.CREATE_NEW_DATABASE] : <input type="text" size="20" name="createdatabase" value="<?php echo $createdatabase; ?>"></td></tr>
			</table>
</td></tr>
<?php if ($installoption>1) { // OPTION superieure a 1 ?>
<tr><td>
<input type="checkbox" name="newsingledatabase" <?php  if ($singledatabase=="on") echo "checked"; ?>[@INSTALL.ONE_DATABASE_FOR_ALL_WEBSITES].
</td></tr>
<tr><td>
[@INSTALL.TABLE_PREFIX] : <input type="text" size="20" name="newtableprefix" value="<?php echo $tableprefix ? $tableprefix : ($installoption==1 ? "lodel_" : ""); ?>">
</td></tr>
<?php } ?>
</table><br />
<input type="submit" value="[@INSTALL.CONTINUE]" />

</form>
<?php  include("tpl/install-closehtml.html"); ?>