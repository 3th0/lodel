<DEFMACRO NAME="HEADER_HEAD_OPEN">
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
	<html>
	<head>
	<meta http-equiv="Content-Type" content="text/html; charset=[#CHARSET]">
</DEFMACRO>

<DEFMACRO NAME="HEADER_HEAD_CLOSE">  
	<link rel="stylesheet" href="styles_lodel.css">
        <IF COND="[#STYLECSS]">
        <style type="text/css">          
           [#STYLECSS]
          
        </style>

        </IF>
	</head>
</DEFMACRO>

<DEFMACRO NAME="CLOSE_HTML">  
	</body>
	</html>
</DEFMACRO>



<DEFMACRO NAME="HEADER_LOGO">
<BODY bgcolor="#FFFFFF"  text="Black" vlink="black" link="black" ALINK="black" onLoad="" MARGINWIDTH="0" MARGINHEIGHT="0" rightmargin="0" leftmargin=0 topmargin=0 bottommargin="0"> 
<USE TEMPLATEFILE="desk">
</DEFMACRO>

<DEFMACRO NAME="HEADER_LOGO_LOGIN">
<BODY bgcolor="#FFFFFF"  text="Black" vlink="black" link="black" ALINK="black" onLoad="" MARGINWIDTH="0" MARGINHEIGHT="0" rightmargin="0" leftmargin=0 topmargin=0 bottommargin="0"> 
</DEFMACRO>





<!--[ -----------------------------------------------------------
      Print error message given the error code
--------------------------------------------------------------- ]-->

<DEFFUNC NAME="PRINT_ERROR_MESSAGE">
	<IF COND="[#ERROR] eq '+'">[@COMMON.ERROR_REQUIRED_FIELD]</IF>
	<IF COND="[#ERROR] eq '1'">[@COMMON.ERROR_FIELD_MUST_BE_UNIQUE]</IF>
	<IF COND="[#ERROR] eq 'date'">[@COMMON.ERROR_INVALID_DATE]</IF>
	<IF COND="[#ERROR] eq 'time'">[@COMMON.ERROR_INVALID_TIME]</IF>
	<IF COND="[#ERROR] eq 'datetime'">[@COMMON.ERROR_INVALID_DATETIME]</IF>
	<IF COND="[#ERROR] eq 'int'">[@COMMON.ERROR_INVALID_INTEGER]</IF>
	<IF COND="[#ERROR] eq 'number'">[@COMMON.ERROR_INVALID_NUMBER]</IF>
	<IF COND="[#ERROR] eq 'class'">[@COMMON.ERROR_INVALID_CLASS]</IF>
	<IF COND="[#ERROR] eq 'type'">[@COMMON.ERROR_INVALID_TYPE]</IF>
	<IF COND="[#ERROR] eq 'username'">[@COMMON.ERROR_INVALID_USERNAME]</IF>
	<IF COND="[#ERROR] eq 'passwd'">[@COMMON.ERROR_INVALID_PASSWD]</IF>
	<IF COND="[#ERROR] eq 'tablefield'">[@COMMON.ERROR_INVALID_FIELD]</IF>
	<IF COND="[#ERROR] eq 'style'">[@COMMON.ERROR_INVALID_STYLE]</IF>
	<IF COND="[#ERROR] eq 'mlstyle'">[@COMMON.ERROR_INVALID_MULTILINGUAL_STYLE]</IF>
	<IF COND="[#ERROR] eq 'url'">[@COMMON.ERROR_INVALID_URL]</IF>
	<IF COND="[#ERROR] eq 'email'">[@COMMON.ERROR_INVALID_EMAIL]</IF>
	<IF COND="[#ERROR] eq 'tplfile'">[@COMMON.ERROR_INVALID_TPLFILE]</IF>
	<IF COND="[#ERROR] eq 'textgroups'">[@COMMON.ERROR_INVALID_TEXTGROUPS]</IF>
	<IF COND="[#ERROR] eq 'readerror'">[@COMMON.ERROR_MISSING_FILE]</IF>
	<IF COND="[#ERROR] eq 'imageformat'">[@COMMON.ERROR_FORMAT_IMAGE]</IF>
	<IF COND="[#ERROR] eq 'reservedsql'">[@COMMON.ERROR_WORD_RESERVED_BY_SQL_OR_LODEL]</IF>
</DEFFUNC>




<!--[ -----------------------------------------------------------
      Widget pour l'edition des differents types de champs
--------------------------------------------------------------- ]-->

<DEFFUNC NAME="PRINT_EDIT_FIELD" REQUIRED="varname,value,type" OPTIONAL="edition,editionparams,eventattr,confirm">
<!--[ --------------- CONFIRM--------------------------- ]-->
<IF COND="[#CONFIRM]">
<LET VAR="eventattr">[#EVENTATTR] onChange="[#CONFIRM]();"</LET>
</IF>
<!--[ --------------- DISPLAY ONLY------------ -------------- ]-->
<IF COND="[#EDITION] eq 'display'">
<span class="displayfield">
	<IF COND="[#TYPE] ne 'passwd'"><div class="editiondisplay">[#VALUE]</div><ELSE/>*******</IF>
<span>
<ELSE/>
<!--[ --------------- TEXT, LONGTEXT, USERNAME, EMAIL, URL -------------- ]-->
<IF COND="[#TYPE] eq 'text' or [#TYPE] eq 'tinytext' or [#TYPE] eq 'longtext' or [#TYPE] eq 'username' or [#TYPE] eq 'longtext' or [#TYPE] eq 'url' or [#TYPE] eq 'email'">

        <IF COND="[#EDITION] eq 'textarea' or (![#EDITION] and [#TYPE] eq 'longtext')">
		<textarea rows="[#EDITIONPARAMS|defaultvalue('10')]" cols="50" name="[#VARNAME]" id="[#VARNAME]" [#EVENTATTR]>[#VALUE]</textarea>
        <ELSE/>
	<IF COND="[#EDITION] eq 'textarea10'">
		<textarea rows="10" cols="50" name="[#VARNAME]" id="[#VARNAME]" [#EVENTATTR]>[#VALUE]</textarea>
	<ELSE/>
	<IF COND="[#EDITION] eq 'textarea30'">
		<textarea rows="30" cols="50" name="[#VARNAME]" id="[#VARNAME]" [#EVENTATTR]>[#VALUE]</textarea>
	<ELSE/>
		<input size="[#EDITIONPARAMS|defaultvalue('50')]" type="text" name="[#VARNAME]" id="[#VARNAME]" [#EVENTATTR] value="[#VALUE]">
	</IF>
	</IF>
        </IF>

<ELSE/>
<!--[ --------------- PASSWD -------------- ]-->
<IF COND="[#TYPE] eq 'passwd'">
<input size="50" type="password" name="[#VARNAME]" id="[#VARNAME]" [#EVENTATTR] >
<ELSE/>
<!--[ --------------- BOOLEAN -------------- ]-->
<IF COND="[#TYPE] eq 'boolean'">
    <input type="checkbox" name="[#VARNAME]" id="[#VARNAME]" [#EVENTATTR] [#VALUE|yes]>
<ELSE/>
<!--[ --------------- MLTEXT -------------- ]-->
<IF COND="[#TYPE] eq 'mltext'">
  <FUNC NAME="EDIT_MLTEXT">
<ELSE/>
<!--[ --------------- LANG,SELECT ------------- ]-->
<IF COND="[#TYPE] eq 'lang' or [#TYPE] eq 'select'">
	      <select name="[#VARNAME]" id="[#VARNAME]" [#EVENTATTR]>
		<?php  makeSelect($context,"value",$context['lo'],$context['type']); ?>
	    </select>
<ELSE/>
<!--[ --------------- MULTIPLESELECT ------------- ]-->
<IF COND="[#TYPE] eq 'multipleselect'">
	      <select name="[#VARNAME][]" id="[#VARNAME]" [#EVENTATTR] multiple>
		<?php  makeSelect($context,"value","",$context['type']); ?>
	    </select>
<ELSE/>
<!--[ --------------- DATE DATETIME TIME ------------- ]-->	    
<IF COND="[#TYPE] eq 'date' or [#TYPE] eq 'datetime' or [#TYPE] eq 'time'">
	<input size="30" type="text" name="[#VARNAME]" id="[#VARNAME]" [#EVENTATTR] value="[(#VALUE|humandate)]">

<ELSE/>
<!--[ --------------- IMAGE ------------- ]-->	    
<IF COND="[#TYPE] eq 'image'">
		
                   <table><tr>
		<IF COND="[#VALUE]"><img src="[(#VALUE|vignette(100))]" border="1"></IF>
                
	        <IF COND="[#VALUE]">
			<input type="radio" name="[#VARNAME][radio]" value="">Conserver l'image courante<br />
			<input type="radio" name="[#VARNAME][radio]" value="delete">[@COMMON.DELETE] <br />
		</IF>
		<input type="radio" id="[#VARNAME][radioserverfile]" name="[#VARNAME][radio]" value="serverfile">
	           <a href="javascript:;" onClick="window.open('filebrowser.php?caller=[#VARNAME]','Upload','width=400,height=300,top=100,left=100');">Choisir un fichier sur le serveur</a>&nbsp;&nbsp;<span id="[#VARNAME][localfilename]">&nbsp;</span><input size="40" type="text" id="[#VARNAME][localfullfilename]"><br />
		<input type="radio" id="[#VARNAME][radioupload]" name="[#VARNAME][radio]" value="upload">Choisir un fichier sur votre disque: <input size="40" type="file" name="[#VARNAME][upload]" onChange="document.getElementById('[#VARNAME][radioupload]').click();">
		 
	        </tr></table>
	        <input  type="hidden" id="[#VARNAME][previousvalue]" VALUE="[#VALUE]">
<ELSE/>
<!--[ --------------- COLOR ------------- ]-->	    
<IF COND="[#TYPE] eq 'color'">
<script language="Javascript" src="colorpicker.js"></script>
<script language="Javascript">
<!--
	var cp_[#NAME] = new ColorPicker(); // DIV style
-->
</script>
<input type="text" name="[#NAME]" size="7" value="[#VALUE]">
<a href="#" onClick="cp_[#NAME].select(document.forms[0].[#NAME],'colorpicker_[#NAME]');return false;" name="colorpicker_[#NAME]" id="colorpicker_[#NAME]">[@ADMIN.CHOOSE_A_COLOR]</a>
<script language="JavaScript">
<!--
document.forms[0].[#NAME].style.backgroundColor='[#VALUE]';
cp_[#NAME].writeDiv();
-->
</script>
<ELSE/>
<!--[ --------------- PERSONS ------------- ]-->	    
<IF COND="[#TYPE] eq 'persons'">
<FUNC NAME="EDIT_PERSONS">
<ELSE/>
<!--[ --------------- ENTRIES ------------- ]-->	    
<IF COND="[#TYPE] eq 'entries'">
<FUNC NAME="EDIT_ENTRIES">
<ELSE/>
???? Don't know how to edit this field. Type: [#TYPE] !
</IF>
</IF>
</IF>
</IF>
</IF>
</IF>
</IF>
</IF>
</IF>
</IF>
</IF>
</IF>
<!--[ error managment ]-->
<LOOP NAME="fielderror" FIELD="[#VARNAME]">
<p class="error"> <FUNC NAME="PRINT_ERROR_MESSAGE" />  </p>
</LOOP>
</DEFFUNC>


<!--[ -----------------------------------------------------------
      Widget for editing a multilingual text
--------------------------------------------------------------- ]-->

<DEFFUNC NAME="EDIT_MLTEXT">
  <div id="mltext_[#VARNAME]" class="mltexteditionarea" >
  <LOOP NAME="mltext"> <!--[ champ multilingue ]-->
    <div ><label class="labelmltext">[(#LANG|humanlang|ucfirst)] :</label> 
	<FUNC NAME="PRINT_EDIT_FIELD" TYPE="text" EDITION="[#EDITION]" VARNAME="[#VARNAME][[#LANG]]" VALUE="[#VALUE]" />
	<a href="#" onClick="deletelanginmltext(this);return false;">[@COMMON.ERASE]</a>
    </div>
  </LOOP>
  <div id="mltext_[#VARNAME]_for_copy" style="display: none;">
	<label class="labelmltext">XXX</label>
	<FUNC NAME="PRINT_EDIT_FIELD" TYPE="text" EDITION="[#EDITION]" VARNAME="[#VARNAME][__lodel_wildcard]" VALUE="" />
	<a href="#" onClick="deletelanginmltext(this);return false;">[@COMMON.DELETE]</a>
  </div>
  <div>
	  <select onChange="addlanginmltext(this,'[#VARNAME]');"><?php makeselectlangs(); ?></select>
  </div>
  </div>
</DEFFUNC>


<!--[ -----------------------------------------------------------
      Widget for editing person
--------------------------------------------------------------- ]-->

<DEFFUNC NAME="EDIT_PERSONS">
  <div id="persons_[#VARNAME]" class="personseditionarea" >
        <LOOP NAME="persontypes" TABLE="persontypes,classes" WHERE="classes.class=persontypes.class AND type='[#VARNAME]' AND classes.classtype='persons'">
        <LET VAR="idtype">[#ID]</LET>
	<LOOP NAME="persons_in_entities">
        <DO>
		<LOOP NAME="edition_fields">
			<BEFORE>
			<div>
			</BEFORE>
		        <DO>
			  <label for="[#NAME]">[#TITLE] :</label><br class="nobr" />
			<FUNC NAME="PRINT_EDIT_FIELD" VARNAME="persons[[#IDTYPE]][[#DEGREE]][[#NAME]]" VALUE="[#VALUE]" TYPE="[#TYPE]" EDITION="[#EDITION]" EDITIONPARAMS="[#EDITIONPARAMS]">
			<br />
		        </DO>
	        	<AFTER>
                        <a href="#" onClick="deletepersons(this); return false;">[@COMMON.DELETE]</a>
			</div>
        		</AFTER>
	    	</LOOP>
	</DO>
	<AFTER>
            <input type="hidden" name="persons[[#VARNAME]][maxdegree]" value="[#MAXDEGREE]">
	</AFTER>
	<ALTERNATIVE>
            <input type="hidden" name="persons[[#VARNAME]][maxdegree]" value="0">
	</ALTERNATIVE>
	</LOOP>
        <!--[ widget available for adding new persons of this type ]-->
 	<LOOP NAME="edition_fields">
		<BEFORE>
	       <div id="persons_[#VARNAME]_for_copy" style="display:none">
			</BEFORE>
		        <DO>
			  <label for="[#NAME]">[#TITLE] :</label><br class="nobr" />
			<FUNC NAME="PRINT_EDIT_FIELD" VARNAME="persons[[#IDTYPE]][__lodel_wildcard][[#NAME]]" VALUE="" TYPE="[#TYPE]" EDITION="[#EDITION]" EDITIONPARAMS="[#EDITIONPARAMS]">
			<br />
		        </DO>
        	<AFTER>
                        <a href="#" onClick="deletepersons(this,'[#VARNAME]'); return false;">[@COMMON.DELETE]</a>
			</div>
        	</AFTER>
	    </LOOP>
         <a href="#" onClick="addpersons(this,'[#VARNAME]'); return false;">[@COMMON.ADD]</a>
      </LOOP>
  </div>
</DEFFUNC>


<!--[ -----------------------------------------------------------
      Widget for editing entry
--------------------------------------------------------------- ]-->

<DEFFUNC NAME="EDIT_ENTRIES">
  <div id="entries_[#VARNAME]" class="entrieseditionarea" >
        <LOOP NAME="entrytypes" TABLE="entrytypes,classes" WHERE="classes.class=entrytypes.class AND type='[#VARNAME]' AND classes.classtype='entries'">
        <LET VAR="idtype">[#ID]</LET>

	<!--[ -----------[ SELECT ]---------- ]-->
	<IF COND="[#EDITION]=='select'">
	<select name="[#VARNAME][]">
		<LOOP NAME="entries_in_entities">
		<option value="[#G_NAME|htmlspecialchars]">[#ROOT][#G_NAME]</option>
		</LOOP>
	</select>
	<ELSE/>
	<!--[ -----------[ POOL ]---------- ]-->
	<IF COND="[#EDITION]=='pool'">
	<FUNC NAME="JS_POOL">
	<table>
	<tr><td>
	<input type="hidden" value="" name="entries[[#IDTYPE]]" id="entries[[#IDTYPE]]" />
	<select multiple size="10" style="width:250px" id="pool_candidats_[#VARNAME]" name="pool_candidats_[#VARNAME]">
		<LOOP NAME="entries_in_entities">
		<option value="[#G_NAME|htmlspecialchars]">[#ROOT][#G_NAME]</option>
		</LOOP>
	</select>
	</td><td>
		<input type="button" value="&rarr;" onclick="addmember('pool_candidats_[#VARNAME]', 'pool_member_[#VARNAME]', 'entries[[#IDTYPE]]')"/><br/>
		<input type="button" value="&larr;" onclick="removemember('pool_member_[#VARNAME]','entries[[#IDTYPE]]')"/>&nbsp;
<input type="button" value="Modify" onclick="modifymember('pool_member_[#VARNAME]', 'entrees[[#ID]][]')"/>
	<td>	
	<select multiple size="10" style="width:250px" id="pool_member_[#VARNAME]" name="pool_member_[#VARNAME]">	
	</select>
	</td>
	</tr>
	<IF COND="[#NEWBYIMPORTALLOWED]">
	<tr><td></td><td></td>
	<td><input type="button" value="^" onclick="addmembertxt('member_more_entries_[#VARNAME]', 'pool_member_[#VARNAME]','entries[[#IDTYPE]]')"/></td></tr>
	<tr><td colspan="3"><input size="50" type="text" id="member_more_entries_[#VARNAME]" name="member_more_entries_[#VARNAME]" /></td></tr>
	</IF>
	</table>



	</IF>
	</IF>

	</LOOP>
    </div>
</DEFFUNC>


<!--[ -----------------------------------------------------------
      JS for advanced feature in the edition of entities

	A Transferer dans le fichier edit_entities_edition.html !!!!!!!!!!!!!!!!!!!!!
--------------------------------------------------------------- ]-->
<DEFMACRO NAME="JS_EDITION_ENTITIES">
	<script type="text/javascript">
<!--

		function addlanginmltext(obj,name){
			var index = obj.selectedIndex;
			var lang = obj.options[index].value;
			if (lang=='--') return;
			var langfull = obj.options[index].childNodes[0].nodeValue;

			var block=document.getElementById('mltext_'+name+'_for_copy')
			var clone=block.cloneNode(true);
			clone.style.display="block";

			// label
			var label=clone.getElementsByTagName('label');
			label[0].childNodes[0].nodeValue=langfull+' :';

			// other fields
			clone.setAttribute('id','');
			changeNameAttributes(clone,lang);

			document.getElementById('mltext_'+name).appendChild(clone);
			obj.selectedIndex=0;
		}

		function deletelanginmltext(obj) 
		{
			// get the edit box
			obj=obj.parentNode;
			var edit=obj.getElementsByTagName("input");
			if (edit.length<1) {
				edit=obj.getElementsByTagName("textarea");
			}
			if (edit[0].value.length>0) {
			 if (!confirm("[@EDITION.CONFIRMATION_DELETE_MLTEXT]")) return;
			}
			obj.parentNode.removeChild(obj);
		}

                function addpersons(obj,name) {
			var block=document.getElementById('persons_'+name+'_for_copy');
			var clone=block.cloneNode(true);
			clone.style.display='block';

                        degreeobj=document.getElementsByName('persons['+name+'][maxdegree]');

			// other fields
			clone.setAttribute('id','');
                        degreeobj[0].value++;
			changeNameAttributes(clone,degreeobj[0].value);
			
			document.getElementById('persons_'+name).appendChild(clone);
			obj.selectedIndex=0;
		}

		function deletepersons(obj,name) 
		{
			// get the edit box
			obj=obj.parentNode;
			var edit=obj.getElementsByTagName("input");
                        var bconfirm=false;
                        for(i=0; i<edit.length; i++) {
                           if (edit[i].value.length>0) bconfirm=true;
                        }
			edit=obj.getElementsByTagName("textarea");
                        for(i=0; i<edit.length; i++) {
                           if (edit[i].value.length>0) bconfirm=true;
                        }
			if (edit.length<1) {
				edit=obj.getElementsByTagName("textarea");
			}
			if (bconfirm) {
			 if (!confirm("[@EDITION.CONFIRMATION_DELETE_PERSONS]")) return;
			}
			obj.parentNode.removeChild(obj);
                        // don't decrease the degree, so that we are sure it is always maximal
		}                


		function changeNameAttributes(obj,index)
		{
			for(i=0; i<obj.childNodes.length; i++) {
				var child=obj.childNodes[i];
				if (child.getAttribute) {
				var name=child.getAttribute('name');
				if (name) {
					newname=name.replace(/__lodel_wildcard/gi,index);
					child.setAttribute('id',newname);
					child.setAttribute('name',newname);
				}
				}
			}
		}	
	//
	--></script>
</DEFMACRO>



<!--[ -----------------------------------------------------------
      JS for the pool. Defined in a function to appear only once

	A Transferer dans le fichier edit_entities_edition.html !!!!!!!!!!!!!!!!!!!!!
--------------------------------------------------------------- ]-->

<DEFFUNC NAME="JS_POOL">
<script type="text/javascript">
<!--

function trim(inputString) {
   // Removes leading and trailing spaces from the passed string. Also removes
   // consecutive spaces and replaces it with one space. If something besides
   // a string is passed in (null, custom object, etc.) then return the input.
   if (typeof inputString != "string") { return inputString; }
   var retValue = inputString;
   var ch = retValue.substring(0, 1);
   while (ch == " ") { // Check for spaces at the beginning of the string
      retValue = retValue.substring(1, retValue.length);
      ch = retValue.substring(0, 1);
   }
   ch = retValue.substring(retValue.length-1, retValue.length);
   while (ch == " ") { // Check for spaces at the end of the string
      retValue = retValue.substring(0, retValue.length-1);
      ch = retValue.substring(retValue.length-1, retValue.length);
   }
   while (retValue.indexOf("  ") != -1) { // Note that there are two spaces in the string - look for multiple spaces within the string
      retValue = retValue.substring(0, retValue.indexOf("  ")) + retValue.substring(retValue.indexOf("  ")+1, retValue.length); // Again, there are two spaces in each of the strings
   }
   return retValue; // Return the trimmed string back to the user
} // Ends the "trim" function


function addmember(candidats, membres, textfield){	
	var cand = document.getElementById(candidats);
	var memb = document.getElementById(membres);
	for(i=0; i<cand.length; i++){
		if(cand.options[i].selected){
			opttxt = cand.options[i].text;
			optval = cand.options[i].value;
			dbl = false;
			if(memb.length > 0){
				for(j=0; j < memb.length; j++){
					if(memb.options[j].value == optval){
						dbl = true;
					}
				}
			}
			if(dbl == false){
				newopt = new Option(opttxt, optval);
				memb.options[memb.length] = newopt;
			}
		}
	}
	updatetxt(textfield, membres);
}

function addmembertxt(candidats, membres, textfield){	
	var cand = document.getElementById(candidats);
	var memb = document.getElementById(membres);
	var tab = cand.value.split(",");
	for(i=0; i<tab.length; i++){
		opttxt = trim(tab[i]);
		optval = 'fromtxt|'+trim(tab[i]);
		dbl = false;
		if(memb.length > 0){
			for(j=0; j < memb.length; j++){
				if(memb.options[j].value == optval){
					dbl = true;
				}
			}
		}
		if(dbl == false && optval.replace('fromtxt|','')){
			newopt = new Option(opttxt, optval);
			memb.options[memb.length] = newopt;
		}
	}
	updatetxt(textfield, membres);
}

function removemember(membres, textfield){	
	var memb = document.getElementById(membres);
	var txt = document.getElementById(textfield);
	if(memb.length>0){
		for(i=0; i < memb.length; i++){
			if(memb.options[i].selected){
				memb.options[i] = null;
				i--;
			}
		}
	}
	updatetxt(textfield, membres);
}

function updatetxt(textfield, selectfield, sep){
	var txt = document.getElementById(textfield);
	var slct = document.getElementById(selectfield);
	var str = ''
	if(!sep)sep=",";
	if(slct.length > 0){
		for(i=0; i< slct.length; i++){
			str += slct.options[i].value + sep;
			str = str.replace('fromtxt|','')
		}
	}
	txt.value = str.substring(0, str.length - sep.length);
}

function modifymember(members,textfield){
	memb = document.getElementById(members);
	var a = new RegExp("fromtxt\|(\w+)");
	if(memb.length>0){
		for(i=0; i < memb.length; i++){
			if(memb.options[i].selected && memb.options[i].value.match(a)){
				var val = prompt("",memb.options[i].value.replace('fromtxt|',''));
				if(val == null)val=memb.options[i].value.replace('fromtxt|','');
				if(val != ''){
					memb.options[i].value = 'fromtxt|'+val;
					memb.options[i].text = val;
				}else{
					memb.options[i]=null;
				}
			}
		}
	}
	updatetxt(textfield, members);
}
-->
</script>
</DEFFUNC>
