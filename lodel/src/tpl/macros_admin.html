<!--[

   LODEL - Logiciel d'Edition ELectronique.
   Copyright (c) 2001-2002, Ghislain Picard, Marin Dacos
   Copyright (c) 2003, Ghislain Picard, Marin Dacos, Luc Santeramo, Nicolas Nutten, Anne Gentil-Beccot
   Copyright (c) 2004, Ghislain Picard, Marin Dacos, Luc Santeramo, Anne Gentil-Beccot, Bruno Cénou
   Home page: http://www.lodel.org
   E-Mail: lodel@lodel.org
                             All Rights Reserved
      This program is free software; you can redistribute it and/or modify
      it under the terms of the GNU General Public License as published by
      the Free Software Foundation; either version 2 of the License, or
      (at your option) any later version.
      This program is distributed in the hope that it will be useful,
      but WITHOUT ANY WARRANTY; without even the implied warranty of
      MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
      GNU General Public License for more details.
      You should have received a copy of the GNU General Public License
      along with this program; if not, write to the Free Software
      Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.]-->


<!--[ ****************************************************************** ]-->
<!--[ Librairie Admin                                                    ]-->
<!--[ Auteurs :                                                          ]-->
<!--[ Marin Dacos. 2002.                                                 ]-->
<!--[ Nicolas Nutten. 2003.                                              ]-->
<!--[ Cette librairie contient :                                         ]-->
<!--[ <MACRO NAME="AFFICHER_STATUT_DOCUMENT">                            ]-->
<!--[ <MACRO NAME="BOUTON_STATUT_PUBLIER_DOCUMENT">                      ]-->
<!--[ <MACRO NAME="BOUTON_AJOUTER_DOCUMENT_ANNEXE">                      ]-->
<!--[ <MACRO NAME="BOUTON_EDITER_DOCUMENT">                              ]-->
<!--[ <MACRO NAME="BOUTON_EDITER_PUBLICATION">                           ]-->
<!--[ <MACRO NAME="BOUTON_EDITER_PUBLICATION_DEPUIS_DOCUMENT">           ]-->
<!--[ <MACRO NAME="BLOC_CHANGER_ORDRE_DOCUMENT">                         ]-->
<!--[ <MACRO NAME="BLOC_EDITER_DOCUMENT_ANNEXE">	                        ]-->
<!--[ ****************************************************************** ]-->

<DEFMACRO NAME="AFFICHER_STATUT_DOCUMENT">
<!--[ ****************************************************************** ]-->
<!--[ version 2.0                                                        ]-->
<!--[ Affiche le status du document, si on a au moins le niveau          ]-->
<!--[ "rédacteur".                                                       ]-->
<!--[ ****************************************************************** ]-->
	<IF COND="[#LODELUSER.REDACTOR]">
		<IF COND="[#STATUS] ge 1">
			<font color="red" size="-2">(Online)</font>
		<ELSE/><IF COND="[#STATUS] le -1">
			<font color="red" size="-2">(Offline)</font>
		</IF></IF>
	</IF>
</DEFMACRO>

<DEFMACRO NAME="BOUTON_STATUT_PUBLIER_DOCUMENT">
<!--[ ****************************************************************** ]-->
<!--[ version 2.0                                                        ]-->
<!--[ Affiche le status du document et permet aux éditeurs de le publier ]-->
<!--[ Afin d'éviter de générer des 404 par erreur, la dépublication      ]-->
<!--[ ne se fait pas dans cette macro.                                   ]-->
<!--[ ****************************************************************** ]-->
	<IF COND="[#LODELUSER.EDITOR]">
		<IF COND="[#STATUS] lt 0">
			<a class="bouton_statut_publierOFF" href="lodel/edition/index.php?do=publish&id=[#ID]&status=1">
				<span class="bouton_statut_publierOFF">(Offline)</span>
			</a>
		<ELSE/>
				<span class="bouton_statut_publierON">(Online)</span>
		</IF>
	</IF>
</DEFMACRO>

<DEFMACRO NAME="BOUTON_AJOUTER_DOCUMENT_ANNEXE">
<!--[ ****************************************************************** ]-->
<!--[ version 2.0                                                        ]-->
<!--[ Affiche, si on a au moins le niveau "rédacteur", un bouton         ]-->
<!--[ [Ajouter un document annexe].                                      ]-->
<!--[ ****************************************************************** ]-->
	<IF COND="[#LODELUSER.REDACTOR]">
		<a href="lodel/edition/index.php?do=view&lo=entities_advanced&id=[#ID]">
			[Ajouter un document annexe]
		</a>
	</IF>
</DEFMACRO>

<DEFMACRO NAME="BOUTON_EDITER_DOCUMENT">
<!--[ ****************************************************************** ]-->
<!--[ version 2.0                                                        ]-->
<!--[ Affiche, si on a au moins le niveau "rédacteur", un bouton [E]     ]-->
<!--[ afin d'éditer un document.                                         ]-->
<!--[ ****************************************************************** ]-->
	<IF COND="[#LODELUSER.REDACTOR]">
		<a href="lodel/edition/index.php?do=view&id=[#ID]"><span class="pluspetit">[E]</span></a>
	</IF>
</DEFMACRO>

<DEFMACRO NAME="BOUTON_EDITER_PUBLICATION">
<!--[ ****************************************************************** ]-->
<!--[ version 2.0                                                        ]-->
<!--[ Affiche, si on a au moins le niveau "rédacteur", un bouton [E]     ]-->
<!--[ afin d'éditer une publication.                                     ]-->
<!--[ ****************************************************************** ]-->
	<IF COND="[#LODELUSER.REDACTOR]">
			<a href="lodel/edition/index.php?do=view&id=[#ID]">
				<span class="pluspetit">[E]</span>
			</a>
	</IF>
</DEFMACRO>

<DEFMACRO NAME="BOUTON_EDITER_PUBLICATION_DEPUIS_DOCUMENT">
<!--[ ****************************************************************** ]-->
<!--[ version 2.0                                                        ]-->
<!--[ Affiche, si on a au moins le niveau "rédacteur", un bouton [E]     ]-->
<!--[ afin d'éditer une publication depuis un document.                  ]-->
<!--[ ****************************************************************** ]-->
	<IF COND="[#LODELUSER.REDACTOR]">
				<a href="lodel/edition/index.php?id=[#IDPARENT]">
					<span class="pluspetit">[V]</span>
				</a>
	</IF>
</DEFMACRO>

<DEFMACRO NAME="BLOC_CHANGER_ORDRE_DOCUMENT">
<!--[ ****************************************************************** ]-->
<!--[ version 2.0                                                        ]-->
<!--[ Affiche si on a au moins le niveau "rédacteur" des boutons pour    ]-->
<!--[ changer l'ordre d'affichage des documents.                         ]-->
<!--[ Les boutons sont disponibles de deux aspects différents :          ]-->
<!--[ Soit sous forme de textes, soit sous forme d'images, l'aspect par  ]-->
<!--[ défaut sont les images. Pour passer d'un aspect à l'autre il       ]-->
<!--[ suffit de commenter les lignes soit des images soit des textes.    ]-->
<!--[ ****************************************************************** ]-->
	<IF COND="[#LODELUSER.REDACTOR]">
		<a href="lodel/edition/index.php?do=changerank&dir=up&id=[#ID]">
			<!--[<span class="texte_trespetit">[haut]</span>]-->
			<MACRO NAME="IMG_HAUT">
		</a>
		<a href="lodel/edition/index.php?do=changerank&dir=down&id=[#ID]">
		<!--[<span class="texte_trespetit">[bas]</span>]-->
			<MACRO NAME="IMG_BAS">
		</a>
	</IF>
</DEFMACRO>

<DEFMACRO NAME="BLOC_EDITER_DOCUMENT_ANNEXE">	
<!--[ ****************************************************************** ]-->
<!--[ version 2.0                                                        ]-->
<!--[ Affiche, si on a au moins le niveau "rédacteur", un bouton         ]-->
<!--[ [modifier] pour modifier le document annexe ou sa description      ]-->
<!--[ ainsi que des boutons [haut] [bas] pour changer son ordre.         ]-->
<!--[ ****************************************************************** ]-->
	<IF COND="[#LODELUSER.REDACTOR]">
		<span class="texte_tres_petit">
			<!--[ Modifier ]-->
			<a class="admin" href="lodel/edition/index.php?do=view&id=[#ID]">[modifier]</a>
			 |
			<!--[ Monter ]-->
				<a href="lodel/edition/index.php?do=changerank&dir=down&id=[#ID]&dir=up">[haut]</a>
			 |
			<!--[ Descendre ]-->
				<a href="lodel/edition/index.php?do=changerank&dir=down&id=[#ID]&dir=down">[bas]</a>
		</span>
	</IF>
</DEFMACRO>

<!--[ ****************************************************************** ]-->
<!--[ version 1.0                                                        ]-->
<!--[ Affiche le formulaire du moteur de recherche 											 ]-->
<!--[ ****************************************************************** ]-->
<DEFFUNC NAME="SEARCH_ENGINE_PUBLIC" OPTIONAL="query,qstatus,qtype,qfield">

<form name="search" action="search.php" method="get">
<input class="searchfields" type="text" name="query" value="<IF COND="![#QUERY]"><ELSE/>[#QUERY|htmlspecialchars|stripslashes]</IF>" />
<input class="searchbutton" type="submit" name="submit_s" value="<IF COND="[#QUERY]">Affiner la recherche<ELSE/>Rechercher</IF>" />
<a href="#" onclick="if(document.getElementById('advanced_search').style.display=='none'){document.getElementById('advanced_search').style.display='inline';} else {document.getElementById('advanced_search').style.display='none';} ">
	<span class="texte_petit">avancée</span>
</a>
<span  id="advanced_search" <IF COND="![#QSTATUS] AND ![#QTYPE] AND ![#QFIELD]">style="display : none"</IF>>
<fieldset class="searchfieldset">
<legend>Recherche avancée</legend>

<LOOP NAME="listtypes" TABLE="types" WHERE="search=1"ORDER="rank" >
<BEFORE>
	&nbsp;Type :&nbsp;
	<select  id="qtype" name="qtype" class="searchfields" <!--[onchange="updatefields(this);"]-->>
	<option id="[#CLASS]_[#ID]" value=""> -- Tous -- </option>
</BEFORE>
<DO>
	<option id="[#CLASS]_[#ID]" value="[#ID]"<IF COND="[#ID] EQ [#QTYPE]">selected="selected"</IF>>[#TITLE]</option>
</DO>
<AFTER>
	</select>
</AFTER>
</LOOP>

&nbsp;Champ : &nbsp;
<select id="qfield" name="qfield" class="searchfields">
	<option value=""> -- Tous --</option>
	<option value="DC.Title" <IF COND="[#QFIELD] EQ 'DC.Title'">selected="selected"</IF>>[@TITLE]</option>
	<option value="DC.Description" <IF COND="[#QFIELD] EQ 'DC.Description'">selected="selected"</IF>>[@DESCRIPTION]</option>
	<option value="DC.Format" <IF COND="[#QFIELD] EQ 'DC.Format'">selected="selected"</IF>>[@FORMAT]</option>
	<option value="DC.Source" <IF COND="[#QFIELD] EQ 'DC.Source'">selected="selected"</IF>>[@SOURCE]</option>
	<option value="DC.Language" <IF COND="[#QFIELD] EQ 'DC.Language'">selected="selected"</IF>>[@LANGUAGE]</option>
	<option value="DC.Relation" <IF COND="[#QFIELD] EQ 'DC.Relation'">selected="selected"</IF>>[@RELATION]</option>
	<option value="DC.Coverage" <IF COND="[#QFIELD] EQ 'DC.Coverage'">selected="selected"</IF>>[@COVERAGE]</option>
	<option value="DC.Rights" <IF COND="[#QFIELD] EQ 'DC.Rights'">selected="selected"</IF>>[@RIGHTS]</option>
</select>

</fieldset>
</span>
</form>		
</DEFFUNC>

