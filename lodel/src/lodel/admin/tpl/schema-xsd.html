<!--

   LODEL - Logiciel d'Edition ELectronique.
   Copyright (c) 2001-2002, Ghislain Picard, Marin Dacos
   Copyright (c) 2003, Ghislain Picard, Marin Dacos, Luc Santeramo, Nicolas Nutten, Anne Gentil-Beccot
   Home page: http://www.lodel.org
   E-Mail: lodel@lodel.org
                             All Rights Reserved
      This program is free software; you can redistribute it and/or modify
      it under the terms of the GNU General Public License as published by
      the Free Software Foundation; either version 2 of the License, or
      (at your option) any later version.
      This program is distributed in the hope that it will be useful,
      but WITHOUT ANY WARRANTY; without even the implied warranty of
      MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
      GNU General Public License for more details.
      You should have received a copy of the GNU General Public License
      along with this program; if not, write to the Free Software
      Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.-->

<xsd:schema targetNamespace="http://www.lodel.org"
                xmlns="http://www.lodel.org"
                xmlns:xsd="http://www.w3.org/2001/XMLSchema"
                xmlns:xhtml="http://www.w3.org/2002/08/xhtml"
                elementFormDefault="qualified">

<xsd:import namespace="http://www.w3.org/2002/08/xhtml"
                schemaLocation="http://www.w3.org/2002/08/xhtml/xhtml1-strict.xsd"/>

<!-- structure general du document -->
    <xsd:element name="document" type="documentType"/>
	<xsd:complexType name="documentType">
            <xsd:sequence>
	<!-- les groupes de personnes -->
    	<LOOP NAME="typepersonnes" TABLE="typepersonnes" WHERE="statut gt 0" ORDER="ordre">
		<DO>
                <xsd:element name="gr[#TYPE]" minOccurs="0" maxOccurs="1">
		     <xsd:complexType>
		       <xsd:sequence>
		           <xsd:element name="[#TYPE]" ref="typePersonne" minOccurs="1" maxOccurs="unbounded" />
		       </xsd:sequence>
		     </xsd:complexType>
		</xsd:element>
		</DO>
   	</LOOP>
	<!-- les groupes d'entrees -->
    	<LOOP NAME="typeentrees" TABLE="typeentrees" WHERE="statut gt 0" ORDER="ordre">
	      	<DO>
                <xsd:element name="gr[#TYPE]" minOccurs="0" maxOccurs="1">
		     <xsd:complexType>
		       <xsd:sequence>
		           <xsd:element name="[#TYPE]" ref="typeEntree" minOccurs="1" maxOccurs="unbounded" />
		       </xsd:sequence>
		     </xsd:complexType>
		</xsd:element>

		</DO>
	</LOOP>
	<!-- les groupes de champs -->
	    <LOOP NAME="groupesdechamps" TABLE="groupesdechamps" WHERE="classe='[#CLASSE]'" ORDER="ordre">
      	<DO>
	        [<xsd:annotation>
				<xsd:documentation xml:lang="fr">
					(#COMMENTAIRE)
				</xsd:documentation>
			</xsd:annotation>]
			<xsd:element ref="[#NOM]">
			 <xsd:complexType>
		            <xsd:sequence>

		<LOOP NAME="champs" TABLE="champs" WHERE="idgroupe='[#ID]'" ORDER="ordre">
	    		<DO>
		        [<xsd:annotation>
					<xsd:documentation xml:lang="fr">
						(#COMMENTAIRE)
					</xsd:documentation>
				</xsd:annotation>]
				<IF COND="[#TYPE] eq 'boolean'">
				<xsd:element name="[#NOM]" type="xsd:boolean"/>
				<ELSE/>
				<IF COND="[#TYPE] eq 'mltext'">
				<xsd:element name="[#NOM]" type="TexteMultiLangue"/>
				<ELSE/>
  	        		<IF COND="[#TYPE] eq 'lang'">
				<xsd:element name="[#NOM]" type="xsd:language"/>
				<ELSE/>
		 		<IF COND="[#TYPE] eq 'date'">
				<xsd:element name="[#NOM]" type="xsd:date"/>
				<ELSE/>
		 		<IF COND="[#TYPE] eq 'datetime'">
				<xsd:element name="[#NOM]" type="xsd:dateTime"/>
				<ELSE/>
		 		<IF COND="[#TYPE] eq 'time'">
				<xsd:element name="[#NOM]" type="xsd:time"/>
				<ELSE/>
		 		<IF COND="[#TYPE] eq 'int'">
				<xsd:element name="[#NOM]" type="xsd:int"/>
				<ELSE/>
		 		<IF COND="[#TYPE] eq 'numeric'">
				<xsd:element name="[#NOM]" type="xsd:double"/>
				<ELSE/>
		 		<IF COND="[#TYPE] eq 'image'">
				<xsd:element name="[#NOM]" type="xsd:anyUrl"/>
				<ELSE/>
		 		<IF COND="[#TYPE] eq 'fichier'">
				<xsd:element name="[#NOM]" type="xsd:anyUrl"/>
				<ELSE/>
				<xsd:element name="[#NOM]" type="xsd:string"/>
				</IF>
				</IF>
				</IF>
				</IF>	
				</IF>
				</IF>
				</IF>
				</IF>
				</IF>	
				</IF>
	    </DO>
	  </LOOP>
		            </xsd:sequence>
			 </xsd:complexType>
	        </xsd:element>
      </DO>
    </LOOP>




		<xsd:element name="meta">
			<xsd:complexType>
				<xsd:element name="typedoc">
					<xsd:simpleType>
						<xsd:restriction base="xsd:string">
						<LOOP NAME="typedoc" TABLE="types" WHERE="classe='documents' AND statut gt 0">
							<xsd:enumeration value="[#TYPE]"/>
						</LOOP>
						</xsd:restriction>
					</xsd:simpleType>
				</xsd:element>
			</xsd:complexType>
	    	</xsd:element>

            </xsd:sequence>
        </xsd:complexType>
    <!-- element document -->



<!-- type GroupePersonne -->

    <xsd:complexType name="typePersonne">
            <xsd:sequence>
	        <xsd:element name="prefix" type="xsd:string" minOccurs="0" maxOccurs="1"/>
		<xsd:element name="nomfamille" type="xsd:string"/>
		<xsd:element name="prenom" type="xsd:string"/>

	        <xsd:element name="description" type="xsd:string" minOccurs="0" maxOccurs="1"/>
		<xsd:element name="fonction" type="xsd:string" minOccurs="0" maxOccurs="1"/>
	        <xsd:element name="affiliation" type="xsd:string" minOccurs="0" maxOccurs="1"/>
	        <xsd:element name="courriel" type="xsd:string" minOccurs="0" maxOccurs="1"/>
            </xsd:sequence>
    </xsd:complexType>

    <xsd:complexType name="typeEntree">
            <xsd:sequence>
		<xsd:element name="nom" type="xsd:string"/>
		<xsd:element name="abrev" type="xsd:string"/>
            </xsd:sequence>
    </xsd:complexType>



<!-- type TexteMultiLangue -->
    <xsd:complexType name="TexteMutliLangue">
            <xsd:sequence>
	        <xsd:element name="ml" type="xsd:string" minOccurs="1" maxOccurs="unbounded">
			<xsd:complexType>
				<xsd:simpleContent>
            				<xsd:extension base="xsd:string">
					        <xsd:attribute name="lang" type="xsd:language" use="required"/>
            				</xsd:extension>
        			</xsd:simpleContent>
    			</xsd:complexType>
		</xsd:element>
            </xsd:sequence>
    </xsd:complexType>

</xsd:schema>