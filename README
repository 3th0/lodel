* edition/index.php

on peut appler index.php?parent=xx ou index.php?id=xx. Dans le second cas, il permet d'editer la publi qui contient xx et non les fils de xx.

* retailler les images

Dans metaimage.html il est possible d'ajouter un champ taille: 
<INPUT NAME="taille" TYPE="text" SIZE="10" VALUE="[#TAILLE]">

Si ce champ est vide, l'image ne subit aucune transformation.
Sinon, l'image prend la taille indique. Exemple 30x100 ou 30 100 redimensionnera l'image a une largeur de 30 et hauteur de 100. Ceci ne marche qu'avec les JPEG et PNG car la librairie gd ne supporte pas les GIF (ca depend des versions).
Il faut install php-gd pour que ca marche. Si on donne une valeur unique, genre 30, il retaille l'image pour que sa plus grande longueur (largeur ou hauteur) fasse 30.

* il y avait un trou de securite (mais avec peu de consequence possible) dans logout.php

* il y a un probleme potentiel dans le parser sur le test du status. Le probleme peut se poser pour les boucles ou il y a deux tables par exemple TABLE="documents" TABLE="auteurs". Dans ce cas, seulement le status de documents (la premiere) est verifiee. Ce n'est pas a priori un gros pb vu qu'un auteur non publie, signifie qu'aucun document qui a cet auteur n'est publie. J'ai fait la modif pour tester le status de toutes les tables. Je pense que ca ne va pas poser de pb de compat, et que ca evitera des soucis a l'avenir. Par contre comme avant, si il y a un test sur le status dans la close WHERE alors le parser n'ajoute aucun test automatique sur le status. Ca n'arrive normalement pas.

* la clause WHERE="okgroupe" ne marche pas si la boucle contient les deux tables: documents et publication (je le mets pour me souvenir ici, mais faut que je documente plus les groupe)

* L'affichage le template vient d'etre mis a jour s'affiche desormais que pour les admin et superadmin, pas pour les editeurs et redacteurs comme avant. Ca evite apres une mise a jour de macros.html d'avoir cette ecriture horrible pour les gens qui n'ecrivent pas de template.

* Pour les groupes, il faut que je vous donne le nv tpl user.html (faut qu'j'y pense)

* Les groupes sans douleur pour ceux qui n'aime pas ca: quand vous aller alterer les tables publications et documents pour ajouter la colonne groupe, il faut la mettre a 1 (ca se fait automatique vu la definition de la valeur par defaut). Par defaut aussi tout utilisateur est dans le groupe 1 (le groupe tous) qui est cree a demeure. Donc ca ne possera aucun pb.

* La suppression d'une publication est boguee, elle ne detruit pas les sous-publications(elles n'ont plus de parent, donc ne sont plus accessible via l'interface d'edition ou les sommaires, mais les documents sont accessibles par l'auteur, les motcles, etc...) et puis ca laisse des detritus dans la base.


* option showhtml pour debugger le code html produit. Il suffit d'ajouter sur l'url &showhtml=1 (quand on vient d'un lien <a href>). Quand on vient d'un formulaire (via submit) c'est moins pratique, il faut ajouter <INPUT HIDDEN NAME="showhtm" VALUE="1"> dans le code du formulaire. A utiliser sans moderation!!!!!!!
Le diagnostique est a la fin. En plus, il y a une numerotation des tr, et un affichage de la table qui semble posee probleme.

* nouvelle fonction sizeattribut pour generer les attributs d'une image. L'argument est le chemin d'acces à l'image. Usage typique: [(#META_IMAGE|sizeattributs)] produit width="20" height="40" par exemple.

* la fonction vignette permet de creer des vignettes (pas dans les documents). [(#META_IMAGE|vignette(30))] creer une vignette dont la plus grande longueur (largeur ou hauteur) est 30 pix. Je peux ajouter des fonctions pour dire que c'est la largeur qui fait 30 ou la hauteur 30 ou pour specifie des taille genre 30x40 sans respecter le ratio. A vous de me dire.



* proposition de status:

° brouillon, non publiable a moins de changer son status.
° non publier (l'actuel non publié).

° publié (l'actuel publié).
° publié protégé (non depubliable a moins de changer son status).

Pour tout ce qui est documents de travail, documents avec soumission je prefere qu'on travaille completement differement avec des series adaptées. Par exemple, une serie soumission qui contient tous les documents soumis. Charge a l'editeur ensuite de le deplacer la ou il l'entend, en l'occurence dans le numero qu'il entend (ce qui est le processus normal de soumission).

S'applique aux documents et publications uniquement. Les autres (auteurs, indexls et indexhs conserve le systeme +1 et -1).

La tentative de publication d'une publication -> publi toutes les sous-publication et documents sauf s'ils ont le status brouillon
La tentative de depublication d'une publication qui a le status publié protégé ou contient une publication ou document qui a ce statut conduit a une liste des documents ou publication qui ont ce statut. Charge a l'editeur de changer les status.


**********************************************************************
23/11


* tous les tags sont passes en minuscule. Il faut changer tous les fichiers en xml archive (pour etre XML correcte et parce que le code n'est plus case-insensitive)

* [#ERREUR_FICHIERNONRTF] est a tester dans chargement.html pour afficher un message comme quoi le fichier n'est pas du rtf. A la place de "desuet" !
